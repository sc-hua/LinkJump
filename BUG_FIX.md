# Bugä¿®å¤è¯´æ˜

## ğŸ› é—®é¢˜æè¿°
é”™è¯¯æç¤º: "Cannot read properties of undefined (reading 'sendMessage')"

## ğŸ” é—®é¢˜åŸå› 
åœ¨ä¹‹å‰çš„ä¿®æ”¹ä¸­ï¼Œæˆ‘ä»¬ç§»é™¤äº†content.jsä¸­çš„`sendMessage`è°ƒç”¨ï¼Œä½†æ˜¯Firefoxå’ŒSafariçš„background.jsä¸­ä»ç„¶ä¿ç•™äº†`onMessage.addListener`ï¼Œè¿™å¯¼è‡´äº†æœªå®šä¹‰çš„å¼•ç”¨é”™è¯¯ã€‚

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. ç§»é™¤æ— ç”¨çš„æ¶ˆæ¯ç›‘å¬å™¨
**Firefox & Safari**: ç§»é™¤äº†`browser.runtime.onMessage.addListener`å’Œ`chrome.runtime.onMessage.addListener`

### 2. ç»Ÿä¸€èœå•ç´¢å¼•ç³»ç»Ÿ  
**æ‰€æœ‰æ‰©å±•**: æ”¹ä¸ºä½¿ç”¨`menu-0`, `menu-1`ç­‰ç»Ÿä¸€çš„èœå•IDï¼Œé¿å…ç´¢å¼•å†²çª

### 3. æ·»åŠ URLç¼“å­˜æœºåˆ¶
**æ‰€æœ‰æ‰©å±•**: æ·»åŠ `currentUrl`ç¼“å­˜ï¼Œé¿å…é‡å¤åˆ›å»ºç›¸åŒé¡µé¢çš„èœå•

### 4. æ”¹è¿›é”™è¯¯å¤„ç†
**æ‰€æœ‰æ‰©å±•**: æ·»åŠ è¾¹ç•Œæ£€æŸ¥ï¼Œç¡®ä¿èœå•ç´¢å¼•åœ¨æœ‰æ•ˆèŒƒå›´å†…

## ğŸ¯ ä¿®å¤æ•ˆæœ

âœ… **æ¶ˆé™¤é”™è¯¯**: ä¸å†æœ‰sendMessageç›¸å…³çš„é”™è¯¯  
âœ… **ç»Ÿä¸€é€»è¾‘**: æ‰€æœ‰æµè§ˆå™¨æ‰©å±•ä½¿ç”¨ç›¸åŒçš„èœå•åˆ›å»ºå’Œå¤„ç†é€»è¾‘  
âœ… **æå‡æ€§èƒ½**: é¿å…é‡å¤åˆ›å»ºèœå•ï¼Œå‡å°‘ä¸å¿…è¦çš„APIè°ƒç”¨  
âœ… **å¢å¼ºç¨³å®šæ€§**: æ·»åŠ é”™è¯¯æ£€æŸ¥ï¼Œé˜²æ­¢ç´¢å¼•è¶Šç•Œç­‰é—®é¢˜

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶
- `Firefox/background.js`: ç§»é™¤æ¶ˆæ¯ç›‘å¬ï¼Œç»Ÿä¸€èœå•é€»è¾‘
- `ArXivRedirector Extension/Resources/background.js`: ç§»é™¤æ¶ˆæ¯ç›‘å¬ï¼Œç»Ÿä¸€èœå•é€»è¾‘

ç°åœ¨æ‰€æœ‰æ‰©å±•éƒ½åº”è¯¥æ­£å¸¸å·¥ä½œï¼Œæ²¡æœ‰JavaScripté”™è¯¯ã€‚
