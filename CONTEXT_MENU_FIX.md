# å³é”®èœå•ä¿®å¤è¯´æ˜

## é—®é¢˜åˆ†æ

### âŒ åŸæœ‰é—®é¢˜
1. **ä»æ˜¾ç¤ºäºŒçº§èœå•**: æˆªå›¾æ˜¾ç¤ºè¿˜æœ‰"Page Redirector"çˆ¶çº§èœå•
2. **å“åº”é€Ÿåº¦æ…¢**: å³é”®æ—¶é€šè¿‡æ¶ˆæ¯ä¼ é€’åŠ¨æ€åˆ›å»ºèœå•ï¼Œå¯¼è‡´æœ‰æ—¶ä¸æ˜¾ç¤º

### ğŸ” é—®é¢˜æ ¹æº
1. **æ—¶æœºé—®é¢˜**: ç”¨æˆ·å³é”® â†’ content.jså‘æ¶ˆæ¯ â†’ background.jsåˆ›å»ºèœå•ï¼Œè¿™ä¸ªè¿‡ç¨‹æœ‰å»¶è¿Ÿ
2. **ç´¢å¼•æ··ä¹±**: redirectorså’Œmirrorsçš„ç´¢å¼•å¤„ç†æœ‰é—®é¢˜
3. **é‡å¤åˆ›å»º**: æ¯æ¬¡å³é”®éƒ½é‡æ–°åˆ›å»ºèœå•ï¼Œæ•ˆç‡ä½ä¸‹

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. æ”¹ä¸ºæ ‡ç­¾é¡µäº‹ä»¶é©±åŠ¨
**ä¹‹å‰**: å³é”®æ—¶é€šè¿‡æ¶ˆæ¯åŠ¨æ€åˆ›å»ºèœå•  
**ç°åœ¨**: æ ‡ç­¾é¡µåˆ‡æ¢/URLå˜åŒ–æ—¶é¢„å…ˆåˆ›å»ºèœå•

```javascript
// Remove message-based approach
// chrome.runtime.onMessage.addListener(...);

// Use tab events for better performance
chrome.tabs.onActivated.addListener(...);
chrome.tabs.onUpdated.addListener(...);
```

### 2. ç»Ÿä¸€èœå•ç´¢å¼•ç³»ç»Ÿ
**ä¹‹å‰**: `redirector-0`, `mirror-0` (ç´¢å¼•å†²çª)  
**ç°åœ¨**: `menu-0`, `menu-1`, `menu-2`... (ç»Ÿä¸€ç´¢å¼•)

```javascript
let menuIndex = 0;
redirectors.forEach(() => {
  chrome.contextMenus.create({
    id: `menu-${menuIndex}`,
    // ...
  });
  menuIndex++;
});
```

### 3. ç¼“å­˜ä¼˜åŒ–
**é¿å…é‡å¤åˆ›å»º**: æ·»åŠ URLç¼“å­˜ï¼Œç›¸åŒURLä¸é‡å¤åˆ›å»ºèœå•

```javascript
// Skip if same URL to avoid unnecessary recreation
if (url === currentUrl) return;
currentUrl = url;
```

### 4. ç®€åŒ–content.js
**ç§»é™¤æ¶ˆæ¯ä¼ é€’**: ä¸å†éœ€è¦content.jsç›‘å¬å³é”®äº‹ä»¶å‘é€æ¶ˆæ¯

```javascript
// Before: 20+ lines of event handling
// After: Just the basic page logic
var url = window.location.href;
```

## ğŸ¯ æŠ€æœ¯ä¼˜åŠ¿

1. **å“åº”æ›´å¿«**: èœå•åœ¨é¡µé¢åŠ è½½æ—¶é¢„å…ˆåˆ›å»ºï¼Œå³é”®å³æ˜¾ç¤º
2. **é¿å…å†²çª**: ç»Ÿä¸€çš„èœå•IDç³»ç»Ÿï¼Œç´¢å¼•ä¸ä¼šæ··ä¹±  
3. **å‡å°‘å†—ä½™**: ç›¸åŒURLä¸é‡å¤åˆ›å»ºï¼Œæå‡æ€§èƒ½
4. **ä»£ç æ›´ç®€**: ç§»é™¤ä¸å¿…è¦çš„æ¶ˆæ¯ä¼ é€’é€»è¾‘

## ğŸ“‹ ä¿®æ”¹çš„æ–‡ä»¶

### Chrome
- `background.js`: é‡æ„èœå•åˆ›å»ºé€»è¾‘ï¼Œä½¿ç”¨æ ‡ç­¾é¡µäº‹ä»¶
- `content.js`: ç®€åŒ–ï¼Œç§»é™¤å³é”®äº‹ä»¶ç›‘å¬

### Firefox
- `content.js`: ç®€åŒ–ï¼Œç§»é™¤å³é”®äº‹ä»¶ç›‘å¬  

### Safari
- `content.js`: ç®€åŒ–ï¼Œç§»é™¤å³é”®äº‹ä»¶ç›‘å¬

## ğŸ‰ é¢„æœŸæ•ˆæœ

- **ä¸€çº§èœå•**: ç›´æ¥æ˜¾ç¤º"Open in HJFY"ç­‰é€‰é¡¹ï¼Œæ— äºŒçº§ç»“æ„
- **å¿«é€Ÿå“åº”**: å³é”®ç«‹å³æ˜¾ç¤ºèœå•ï¼Œæ— å»¶è¿Ÿ
- **ç¨³å®šå¯é **: é¿å…äº†æ¶ˆæ¯ä¼ é€’å¯èƒ½çš„å¤±è´¥æƒ…å†µ
